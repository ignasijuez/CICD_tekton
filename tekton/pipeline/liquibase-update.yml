apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: liquibase-update
spec:
  workspaces:
    - name: output
  steps:
    - name: run-liquibase
      image: liquibase/liquibase:latest
      script: |
        #!/bin/sh
        
        echo "------------------------------"
        echo "------------------------------"
        echo "pwd: "
        pwd
        echo "------------------------------"
        echo "------------------------------"
        echo "ls -R"
        ls -R
        echo "------------------------------"
        echo "------------------------------"

        liquibase \
          --url=jdbc:h2:mem:testdb \
          --changeLogFile=/liquibase/examples/mysql/changelog.xml \
          --username=sa \
          --password='' \
          update